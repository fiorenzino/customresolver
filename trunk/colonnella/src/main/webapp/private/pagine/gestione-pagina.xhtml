<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	template="/WEB-INF/layout/t.xhtml">

	<ui:define name="title">
		<h:outputText value="Gestione Pagina" />
	</ui:define>

	<ui:define name="content">
		<style>
.col1 {
	width: 35%;
	text-align: left;
}

.col2 {
	width: 65%;
	text-align: left;
}
</style>
		<script type="text/javascript"
			src="#{request.contextPath}/js/it_editor.js"></script>
		<script type="text/javascript">
         //<![CDATA[
function addImageBrowser() {
            myEditor.on('toolbarLoaded', function() {
    //When the toolbar is loaded, add a listener to the insertimage button
    this.toolbar.on('insertimageClick', function() {
        //Get the selected element
        var _sel = this._getSelectedElement();
        //If the selected element is an image, do the normal thing so they can manipulate the image
        if (_sel && _sel.tagName && (_sel.tagName.toLowerCase() == 'img')) {
            //Do the normal thing here..
        } else {
            //They don't have a selected image, open the image browser window
            win = window.open('#{request.contextPath}/private/gallerie/images.jsf', 'IMAGE_BROWSER',
                'left=20,top=20,width=500,height=500,toolbar=0,resizable=0,status=0');
            if (!win) {
                //Catch the popup blocker
                alert('Please disable your popup blocker!!');
            }
            //This is important.. Return false here to not fire the rest of the listeners
            return false;
        }
    }, this, true);
}, myEditor, true);

         }

          window.onload = addImageBrowser;
         //]]>
      </script>

		<h:form>

			<p:panel header="Gestione Pagina">

				<h:panelGrid columns="2" style="width: 95%"
					columnClasses="col1,col2">

					<h:outputLabel value="Titolo(*):" for="titoloW"
						rendered="#{empty pageHandler.element.title}" />
					<h:inputText required="true" id="titoloW"
						value="#{pageHandler.element.title}" style="width: 100%;"
						rendered="#{empty pageHandler.element.title}" />

					<h:outputLabel value="Titolo:" for="titoloR"
						rendered="#{not empty pageHandler.element.title}" />
					<h:inputText disabled="true" id="titoloR"
						value="#{pageHandler.element.title}" style="width: 100%;"
						rendered="#{not empty pageHandler.element.title}" />

					<h:outputLabel value="Descrizione:" for="descrizione" />
					<h:inputText id="descrizione"
						value="#{pageHandler.element.description}" style="width: 100%;" />

					<h:outputLabel value="Modello(*):" for="template" />
					<h:panelGroup id="template">
						<h:selectOneMenu
							rendered="#{pageHandler.element.template.template.statico}"
							value="#{pageHandler.element.template.template.id}"
							required="true" style="width: 100%">
							<f:selectItems value="#{propertiesHandler.templateStaticiItems}" />
							<p:ajax actionListener="#{pageHandler.cambioTemplate}"
								update="campi" event="change" process="@this" />
						</h:selectOneMenu>
						<h:selectOneMenu
							rendered="#{not pageHandler.element.template.template.statico}"
							value="#{pageHandler.element.template.template.id}"
							required="true" style="width: 100%">
							<f:selectItems value="#{propertiesHandler.templateDinamiciItems}" />
							<p:ajax actionListener="#{pageHandler.cambioTemplate}"
								update="campi" event="change" process="@this" />
						</h:selectOneMenu>
					</h:panelGroup>

					<h:outputText value="&lt;hr/&gt;" escape="false" />
					<h:outputText />

				</h:panelGrid>

				<h:panelGroup id="campi">

					<h:panelGrid columns="2" style="width: 95%"
						columnClasses="col1,col2">

						<h:outputLabel value="Intestazione:"
							rendered="#{not empty pageHandler.element.template.template.header_stop}"
							for="header" />
						<h:panelGroup
							rendered="#{not empty pageHandler.element.template.template.header_stop}"
							id="header">
							<h:inputTextarea
								rendered="#{not empty pageHandler.element.template.template.header_stop and not pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.header}"
								style="color: black; width: 100%;" escape="false" />
							<p:editor id="advancedTextAreaH"
								rendered="#{not empty pageHandler.element.template.template.header_stop and pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.header}" width="100%"
								height="320px" widgetVar="myEditor" language="it" />
						</h:panelGroup>

						<h:outputText value="&lt;hr/&gt;"
							rendered="#{not empty pageHandler.element.template.template.header_stop}"
							escape="false" />
						<h:outputText
							rendered="#{not empty pageHandler.element.template.template.header_stop}" />

						<h:outputLabel value="Colonna 1:"
							rendered="#{not empty pageHandler.element.template.template.col1_stop}"
							for="col1" />
						<h:panelGroup id="col1"
							rendered="#{not empty pageHandler.element.template.template.col1_stop}">
							<h:inputTextarea
								rendered="#{not empty pageHandler.element.template.template.col1_stop and not pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.col1}"
								style="color: black; width: 100%;" escape="false" />
							<p:editor id="advancedTextAreaC1"
								rendered="#{not empty pageHandler.element.template.template.col1_stop and pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.col1}" width="100%"
								height="320px" widgetVar="myEditor" language="it" />
						</h:panelGroup>

						<h:outputLabel value="Colonna 2:"
							rendered="#{not empty pageHandler.element.template.template.col2_stop}"
							for="col2" />
						<h:panelGroup id="col2"
							rendered="#{not empty pageHandler.element.template.template.col2_stop}">
							<h:inputTextarea
								rendered="#{not empty pageHandler.element.template.template.col2_stop and not pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.col2}"
								style="color: black; width: 100%;" escape="false" />
							<p:editor id="advancedTextAreaC2"
								rendered="#{not empty pageHandler.element.template.template.col2_stop and pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.col2}" width="100%"
								height="320px" widgetVar="myEditor" language="it" />
						</h:panelGroup>

						<h:outputLabel value="Colonna 3:"
							rendered="#{not empty pageHandler.element.template.template.col3_stop}"
							for="col3" />
						<h:panelGroup id="col3"
							rendered="#{not empty pageHandler.element.template.template.col3_stop}">
							<h:inputTextarea
								rendered="#{not empty pageHandler.element.template.template.col3_stop and not pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.col3}" width="100%"
								style="color: black; width: 100%;" escape="false" />
							<p:editor id="advancedTextAreaC3"
								rendered="#{not empty pageHandler.element.template.template.col3_stop and pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.col3}"
								height="320px" widgetVar="myEditor" language="it" />
						</h:panelGroup>

						<h:outputText value="&lt;hr/&gt;"
							rendered="#{(not empty pageHandler.element.template.template.col1_stop) or (not empty pageHandler.element.template.template.col2_stop) or (not empty pageHandler.element.template.template.col3_stop)}"
							escape="false" />
						<h:outputText
							rendered="#{(not empty pageHandler.element.template.template.col1_stop) or (not empty pageHandler.element.template.template.col2_stop) or (not empty pageHandler.element.template.template.col3_stop)}" />

						<h:outputLabel value="Pie' di pagina:"
							rendered="#{not empty pageHandler.element.template.template.footer_stop}"
							for="footer" />
						<h:panelGroup id="footer"
							rendered="#{not empty pageHandler.element.template.template.footer_stop}">
							<h:inputTextarea
								rendered="#{not empty pageHandler.element.template.template.footer_stop and not pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.footer}"
								style="color: black; width: 100%;" escape="false" />
							<p:editor id="advancedTextAreaF"
								rendered="#{not empty pageHandler.element.template.template.footer_stop and pageHandler.element.template.template.statico}"
								value="#{pageHandler.element.template.footer}" width="100%"
								height="320px" widgetVar="myEditor" language="it" />
						</h:panelGroup>

					</h:panelGrid>

				</h:panelGroup>
				<br />
				<h:outputText value="(*) sono campi obbligatori!" />
				<br />
				<br />

			</p:panel>

			<br />
			<br />

			<center><h:panelGrid columns="3">
				<h:commandLink value="anteprima testo completo"
					action="#{pageHandler.anteprimaTestuale}" target="_blank" />
				<h:outputText value=" - " rendered="false"/>
				<h:commandLink value="anteprima risultato finale"
					action="#{pageHandler.anteprimaRisultato}" target="_blank" rendered="false"/>
			</h:panelGrid> <br />
			<h:panelGrid columns="4">
				<h:commandButton action="#{pageHandler.save}" value="Salva"
					rendered="#{empty pageHandler.element.id}" />
				<h:commandButton action="#{pageHandler.update}"
					value="Salva le modifiche"
					rendered="#{not empty pageHandler.element.id}" />
				<h:commandButton action="#{pageHandler.delete}" value="Elimina"
					immediate="true" rendered="#{not empty pageHandler.element.id}" />
				<h:commandButton id="reset" action="#{pageHandler.reset}"
					value="Annulla" immediate="true" />
			</h:panelGrid></center>

		</h:form>
	</ui:define>
</ui:composition>